% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/feature_associations.R
\name{feature_associations}
\alias{feature_associations}
\title{Cross-modality feature associations.}
\usage{
feature_associations(
  A,
  A_var,
  B,
  B_var,
  mask = NULL,
  n_epochs = 10000,
  lambda_reg = 1e-04,
  lambda_entropy = 0.001,
  lambda_spread = 0.05,
  temperature = 0.2,
  normalize = TRUE,
  seed = 1898,
  n_threads = 10
)
}
\arguments{
\item{A}{Topic-feature matrix of modality A.}

\item{A_var}{DataFrame from modality A, used for column names.}

\item{B}{Topic-feature matrix of modality B.}

\item{B_var}{DataFrame from modality B, used for row names.}

\item{mask}{Optional boolean mask (shape: n_features_B x n_features_A)
specifying which feature pairs to consider (default: NULL).}

\item{n_epochs}{Number of optimization steps per target feature
(default: 10000).}

\item{lambda_reg}{Regularization coefficient for sparsity
(default: 1e-4).}

\item{lambda_entropy}{Regularization coefficient for entropy
(default: 1e-3).}

\item{lambda_spread}{Regularization coefficient for weight spread
(default: 0.05).}

\item{temperature}{Softmax temperature for controlling assignment sharpness
(default: 0.2).}

\item{normalize}{Whether to check and normalize A and B to ensure row sums
equal 1. (default: TRUE).}

\item{seed}{Random seed for reproducibility (default: 1898).}

\item{n_threads}{Number of threads to use for Torch (default: 10).}
}
\value{
A data frame of shape (n_features_B, n_features_A) with association
 weights.
}
\description{
Learns a feature-level probabilistic mapping from one modality
 to another using KL divergence minimization with regularization. The
 optimization is done independently for each feature in A. The result is a
 sparse matrix showing how features in modality B (columns) associate with
 features in modality A (rows). The model applies softmax-based weighting
 with optional entropy and sparsity regularization.
}
